<!doctype html><html><head><meta charset=utf-8><title>Primeros pasos con LGI (lua y gtk) - diazvictor</title><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=author content="Víctor Díaz"><meta name=description content="En este tutorial te enseñare a constuir una interfaz con lua y gtk usando la libreria LGI"><meta name=keywords content="lua,gtk,lgi"><link rel="shortcut icon" href=images/favicon.png type=image/x-icon><link rel=stylesheet href=/css/bulma.min.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/custom-dark.css><link rel=stylesheet href=/css/all.min.css></head><body><header class="hero is-info is-fullheight"><div class=hero-head><nav class="navbar is-transparent"><div class=container><div class=navbar-brand><a href=/ class="navbar-item is-size-3 is-uppercase">Víctor Díaz</a>
<span class="navbar-burger burger" data-target=navbarMenuHeroB><span></span><span></span><span></span></span></div><div class=navbar-menu><div class=navbar-end><a href=/post class=navbar-item>BLOG</a>
<a href=/about class=navbar-item>ABOUT</a><div class=navbar-item><a id=toggle-theme class="button is-info is-rounded is-hovered is-medium" title="Dark mode"><span class=icon><i class="fas fa-moon"></i></span></a></div></div></div></div></nav></div><div class=hero-body><div class=container><h1 class="title is-1">Primeros pasos con LGI (lua y gtk)</h1><h2 class=subtitle><i class="fas fa-calendar"></i>&nbsp;21 January, 2021&nbsp;&nbsp;&nbsp;
<i class="fas fa-clock"></i>&nbsp;3 minute read</h2><a href=https://diazvictor.github.io/tags/lua/ class="tag is-light">lua</a>
<a href=https://diazvictor.github.io/tags/gtk/ class="tag is-light">gtk</a>
<a href=https://diazvictor.github.io/tags/lgi/ class="tag is-light">lgi</a>
<a href=https://diazvictor.github.io/tags/tutorial/ class="tag is-light">tutorial</a><br><br><p>En este tutorial te enseñare a constuir una interfaz con lua y gtk usando la libreria LGI</p></div></div></header><div id=content><div class=columns><div class="column is-8"><section class=section><article class=box><div class=content><h2 id=cómo-empezar>Cómo empezar</h2><p>Más que un tutorial, es el ejemplo más simple de como crear una ventana vacía.
Luego, extenderemos el script para agregarle un botón que realiza una determinada acción.</p><p>Antes de comenzar, recomiendo los siguientes documentos para que podamos aprender
un poco más sobre LGI:</p><ul><li><a href=https://github.com/pavouk/lgi/blob/master/docs/overview.md>https://github.com/pavouk/lgi/blob/master/docs/overview.md</a></li><li><a href=https://github.com/pavouk/lgi/blob/master/docs/guide.md>https://github.com/pavouk/lgi/blob/master/docs/guide.md</a></li><li><a href=https://github.com/pavouk/lgi/blob/master/docs/gtk.md>https://github.com/pavouk/lgi/blob/master/docs/gtk.md</a></li></ul><p>Puedes instalar lgi usando LuaRocks:</p><pre><code>luarocks install lgi
</code></pre><p>O con el gestor de paquetes de tu distro (si está disponible).</p><h2 id=ejemplo-simple>Ejemplo Simple</h2><p>Para comenzar con nuestro tutorial crearemos el ejemplo más simple posible.
Este programa creará una ventana vacía de 200 x 200 píxeles.</p><p><img src=/images/post/primeros-pasos-con-lua-gtk/screen1.jpg alt=simple-window.lua></p><p>Primero crearemos un archivo de nombre <code>sample-window.lua</code>
con el siguiente codigo:</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=kd>local</span> <span class=n>lgi</span> <span class=o>=</span> <span class=n>require</span><span class=p>(</span><span class=s1>&#39;lgi&#39;</span><span class=p>)</span>
<span class=kd>local</span> <span class=n>Gtk</span> <span class=o>=</span> <span class=n>lgi.require</span><span class=p>(</span><span class=s1>&#39;Gtk&#39;</span><span class=p>,</span> <span class=s1>&#39;3.0&#39;</span><span class=p>)</span>

<span class=kd>local</span> <span class=n>window</span> <span class=o>=</span> <span class=n>Gtk.Window</span> <span class=p>{</span>
	<span class=n>title</span> <span class=o>=</span> <span class=s1>&#39;Sample - Window&#39;</span><span class=p>,</span>
	<span class=n>width</span> <span class=o>=</span> <span class=mi>200</span><span class=p>,</span>
	<span class=n>height</span> <span class=o>=</span> <span class=mi>200</span><span class=p>,</span>
	<span class=n>window_position</span> <span class=o>=</span> <span class=n>Gtk.WindowPosition</span><span class=p>.</span><span class=n>CENTER</span><span class=p>,</span>
	<span class=n>on_destroy</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
		<span class=n>Gtk.main_quit</span><span class=p>()</span>
	<span class=kr>end</span>
<span class=p>}</span>

<span class=n>window</span><span class=p>:</span><span class=n>show_all</span><span class=p>()</span>
<span class=n>Gtk.main</span><span class=p>()</span>
</code></pre></div><p>A continuación explicaremos cada línea del ejemplo.</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=kd>local</span> <span class=n>lgi</span> <span class=o>=</span> <span class=n>require</span><span class=p>(</span><span class=s1>&#39;lgi&#39;</span><span class=p>)</span>
<span class=kd>local</span> <span class=n>Gtk</span> <span class=o>=</span> <span class=n>lgi.require</span><span class=p>(</span><span class=s1>&#39;Gtk&#39;</span><span class=p>,</span> <span class=s1>&#39;3.0&#39;</span><span class=p>)</span>
</code></pre></div><p>Para disponer de las clases y funciones de GTK+, es necesario primero cargar la
librería LGI y luego el módulo Gtk. Como el sistema de un usuario puede tener varias
versiones de GTK+ instaladas al mismo tiempo, queremos asegurarnos de que cuando
cargamos Gtk se refiere a GTK+ 3 y no a cualquier otra versión de la librería,
que es el propósito de la sentencia <code>lgi.require('Gtk', '3.0')</code>.</p><p>La siguiente línea crea una ventana vacía con un titulo, un tamaño de 200 x 200,
centramos la ventana en el centro de la pantalla y conectamos la ventana al evento
<code>destroy</code> (que sucede cuando destruimos la ventana o la cerramos) para asegurarnos
de que la aplicación se termina si hacemos clic en la x de la ventana.</p><p>Cabe aclarar que con LGI las señales se conectan con <em>on</em>&lt;nombre de la señal>_</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=n>window</span> <span class=o>=</span> <span class=n>Gtk.Window</span> <span class=p>{</span>
	<span class=n>title</span> <span class=o>=</span> <span class=s1>&#39;Sample - Window&#39;</span><span class=p>,</span> <span class=c1>-- titulo</span>
	<span class=n>width</span> <span class=o>=</span> <span class=mi>200</span><span class=p>,</span> <span class=c1>-- ancho</span>
	<span class=n>height</span> <span class=o>=</span> <span class=mi>200</span><span class=p>,</span> <span class=c1>-- alto</span>
	<span class=n>window_position</span> <span class=o>=</span> <span class=n>Gtk.WindowPosition</span><span class=p>.</span><span class=n>CENTER</span><span class=p>,</span> <span class=c1>-- posición</span>
	<span class=n>on_destroy</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span> <span class=c1>-- evento</span>
		<span class=n>Gtk.main_quit</span><span class=p>()</span>
	<span class=kr>end</span>
<span class=p>}</span>
</code></pre></div><p>En el siguiente paso mostramos la ventana.</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=n>window</span><span class=p>:</span><span class=n>show_all</span><span class=p>()</span>
</code></pre></div><p>Por último, iniciamos el bucle de procesamiento de GTK+, del cual saldremos
cuando la ventana sea cerrada (ver línea 15).</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=n>Gtk.main</span><span class=p>()</span>
</code></pre></div><p>Para ejecutar el programa, abra una terminal, cambie al directorio del archivo y
ingrese el comando:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>lua sample-window.lua
</code></pre></div><h2 id=ejemplo-extendido>Ejemplo Extendido</h2><p>Para algo un poco más útil, aquí está la vesión en LGI del clásico
programa <em>Hello World</em>.</p><p><img src=/images/post/primeros-pasos-con-lua-gtk/screen2.jpg alt=hello-world.lua></p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=kd>local</span> <span class=n>lgi</span> <span class=o>=</span> <span class=n>require</span><span class=p>(</span><span class=s2>&#34;lgi&#34;</span><span class=p>)</span>
<span class=kd>local</span> <span class=n>Gtk</span> <span class=o>=</span> <span class=n>lgi.require</span><span class=p>(</span><span class=s2>&#34;Gtk&#34;</span><span class=p>,</span> <span class=s2>&#34;3.0&#34;</span><span class=p>)</span>
<span class=kd>local</span> <span class=n>MyWindow</span> <span class=o>=</span> <span class=n>Gtk.Window</span><span class=p>:</span><span class=n>derive</span><span class=p>(</span><span class=s2>&#34;MyWindow&#34;</span><span class=p>)</span>

<span class=kr>function</span> <span class=nc>MyWindow</span><span class=p>:</span><span class=nf>_init</span><span class=p>()</span>
	<span class=n>self.title</span> <span class=o>=</span> <span class=s2>&#34;Hello World&#34;</span>

	<span class=kd>local</span> <span class=n>button</span> <span class=o>=</span> <span class=n>Gtk.Button</span><span class=p>({</span> <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;Click Here&#34;</span> <span class=p>})</span>
	<span class=kr>function</span> <span class=nc>button</span><span class=p>:</span><span class=nf>on_clicked</span><span class=p>()</span>
		<span class=n>print</span><span class=p>(</span><span class=s2>&#34;Hello World&#34;</span><span class=p>)</span>
	<span class=kr>end</span>
	<span class=n>self</span><span class=p>:</span><span class=n>add</span><span class=p>(</span><span class=n>button</span><span class=p>)</span>
<span class=kr>end</span>

<span class=kd>local</span> <span class=n>window</span> <span class=o>=</span> <span class=n>MyWindow</span><span class=p>()</span>
<span class=n>window.on_destroy</span> <span class=o>=</span> <span class=n>Gtk.main_quit</span>
<span class=n>window</span><span class=p>:</span><span class=n>show_all</span><span class=p>()</span>

<span class=n>Gtk.main</span><span class=p>()</span>
</code></pre></div><p>A diferencia del ejemplo simple, aquí creamos una sub-clase de <code>Gtk.Window</code> para
definir nuestra propia clase <code>MyWindow</code>.</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=kd>local</span> <span class=n>MyWindow</span> <span class=o>=</span> <span class=n>Gtk.Window</span><span class=p>:</span><span class=n>derive</span><span class=p>(</span><span class=s2>&#34;MyWindow&#34;</span><span class=p>)</span>
</code></pre></div><p>En el constructor de la clase, le diremos que dé el valor de <code>Hello World</code> a la
propiedad <code>title</code>.</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=n>self.title</span> <span class=o>=</span> <span class=s2>&#34;Hello World&#34;</span>
</code></pre></div><p>Las próximas tres líneas son usadas para crear un botón (<em><a href=http://es.wikipedia.org/wiki/Widget>widget</a></em>),
conectarlo a su señal <code>clicked</code>, y adicionarlo como hijo a la ventana.</p><div class=highlight><pre class=chroma><code class=language-lua data-lang=lua><span class=kd>local</span> <span class=n>button</span> <span class=o>=</span> <span class=n>Gtk.Button</span><span class=p>({</span> <span class=n>label</span> <span class=o>=</span> <span class=s2>&#34;Click Here&#34;</span> <span class=p>})</span>
<span class=kr>function</span> <span class=nc>button</span><span class=p>:</span><span class=nf>on_clicked</span><span class=p>()</span>
	<span class=n>print</span><span class=p>(</span><span class=s2>&#34;Hello World&#34;</span><span class=p>)</span>
<span class=kr>end</span>
<span class=n>self</span><span class=p>:</span><span class=n>add</span><span class=p>(</span><span class=n>button</span><span class=p>)</span>
</code></pre></div><p>El último bloque, fuera de la clase, es muy similar al del ejemplo simple de más
arriba, pero en lugar de crear una instancia de la cláse genérica <code>Gtk.Window</code>,
creamos una instancia de <code>MyWindow</code>.</p></div></article><nav class=bd-prev-next-bis><a class=bd-prev-next-bis-previous href=https://diazvictor.github.io/post/estilos-para-gtk3-con-lua-css/ title="Agregando estilos css con LGI (lua + gtk)">← Agregando estilos css con LGI (lua + gtk)</a>
<a class=bd-prev-next-bis-next href=https://diazvictor.github.io/post/guia-mqtt-desde-la-terminal/ title="Guia Mqtt Desde La Terminal">Guia Mqtt Desde La Terminal →</a></nav></section><div class="section comments"><div id=disqus_thread></div><script>(function(){var d=document,s=d.createElement('script');s.src='https://diazvictor.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><div class="column is-4"><div class="section sidebar"><h1 class="title is-4">ABOUT ME</h1><p>Desarrollador web y desktop con conocimientos (backend/frontend) en lenguajes Lua, Php, SQL (SQLite), HTML, CSS y Javascript.</p><hr><h1 class="title is-4">LATEST POSTS</h1><ul><li><a href=/post/estilos-para-gtk3-con-lua-css/><b>Agregando estilos css con LGI (lua + gtk)</b></a></li><li><time>21 January, 2021</time></li><div class=has-margin-10 style=margin-bottom:10px></div><li><a href=/post/primeros-pasos-con-lua-gtk/><b>Primeros pasos con LGI (lua y gtk)</b></a></li><li><time>21 January, 2021</time></li><div class=has-margin-10 style=margin-bottom:10px></div><li><a href=/post/guia-mqtt-desde-la-terminal/><b>Guia Mqtt Desde La Terminal</b></a></li><li><time>2 May, 2020</time></li><div class=has-margin-10 style=margin-bottom:10px></div><li><a href=/post/manual-basico-lua/><b>Manual Basico Sobre Lua</b></a></li><li><time>24 April, 2020</time></li><div class=has-margin-10 style=margin-bottom:10px></div></ul><hr><h1 class="title is-4">CATEGORIES</h1><div class="field is-grouped is-grouped-multiline"><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/categories/desarrollo/ class="tag is-light" style=text-transform:uppercase>desarrollo</a></div></div></div><hr><h1 class="title is-4">TAGS</h1><div class="field is-grouped is-grouped-multiline"><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/css/ class="tag is-light">css</a></div></div><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/gtk/ class="tag is-light">gtk</a></div></div><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/lgi/ class="tag is-light">lgi</a></div></div><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/lua/ class="tag is-light">lua</a></div></div><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/manual/ class="tag is-light">manual</a></div></div><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/mosquitto/ class="tag is-light">mosquitto</a></div></div><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/mqtt/ class="tag is-light">mqtt</a></div></div><div class=control><div class="tags has-addons"><a href=https://diazvictor.github.io/tags/tutorial/ class="tag is-light">tutorial</a></div></div></div></div></div></div></div><footer class="footer has-background-info"><div class="content has-text-white"><div class=columns><div class="column is-11"><div class=buttons><a href=https://github.com/diazvictor/ class="button is-link is-medium"><span class=icon><i class="fab fa-github-alt"></i></span></a><a href=https://gitlab.com/diazvictor/ class="button is-link is-medium"><span class=icon><i class="fab fa-gitlab"></i></span></a><a href=https://t.me/diazvictor class="button is-link is-medium"><span class=icon><i class="fab fa-telegram"></i></span></a><a href=mailto:victor.vector008@gmail.com class="button is-link is-medium"><span class=icon><i class="fas fa-envelope"></i></span></a></div></div><div class="column is-1 is-hidden-mobile"><div class="buttons is-right"><a href=#! class="button is-link is-medium btn_top"><span class=icon><i class="fas fa-chevron-up"></i></span></a></div></div></div><hr><p>© 2021 diazvictor · Powered by <a href=https://gohugo.io/ class=has-text-white><u>Hugo</u></a> & <a href=http://bulma.io/ class=has-text-white><u>Bulma</u></a>.</p><div class="buttons is-centered is-hidden-tablet"><a href=#! class="button is-link is-medium btn_top"><span class=icon><i class="fas fa-chevron-up"></i></span></a></div></div></footer><script type=text/javascript src=/js/nav-burger.js></script><script type=text/javascript src=/js/back_to_top.js></script><script type=text/javascript src=/js/toggle-theme.js></script><script type=text/javascript>window.addEventListener('load',function(){var url=window.location.href;sessionStorage.setItem('lastPage',url);});</script></body></html>